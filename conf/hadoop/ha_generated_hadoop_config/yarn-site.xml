<?xml version="1.0"?>
<!--
       Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License. See accompanying LICENSE file.
-->
<configuration>

<!-- Site specific YARN configuration properties -->

<property>
<name>yarn.resourcemanager.ha.enabled</name>
<value>true</value>
</property>
<property>
<name>yarn.resourcemanager.ha.automatic-failover.enabled</name>
<value>true</value>
</property>
<property>
<name>yarn.client.failover-proxy-provider</name>
<value>org.apache.hadoop.yarn.client.ConfiguredRMFailoverProxyProvider</value>
</property>
<property>
<name>yarn.resourcemanager.store.class</name>
<value>org.apache.hadoop.yarn.server.resourcemanager.recovery.ZKRMStateStore</value>
</property>
<property>
<name>yarn.resourcemanager.recovery.enabled</name>
<value>true</value>
</property>
<property>
<name>yarn.resourcemanager.cluster-id</name>
<value>apachehadooptest</value>
</property>
<property>
<name>yarn.resourcemanager.ha.rm-ids</name>
<value>rm1,rm2</value>
</property>

<property>
<name>yarn.resourcemanager.hostname.rm1</name>
<value>13.0.0.120</value>
</property>
<property>
<name>yarn.resourcemanager.hostname.rm2</name>
<value>13.0.0.202</value>
</property>

<property>
<name>yarn.resourcemanager.address.rm1</name>
<value>13.0.0.120:8032</value>
</property>
<property>
<name>yarn.resourcemanager.address.rm2</name>
<value>13.0.0.202:8032</value>
</property>

<property>
<name>yarn.resourcemanager.webapp.address.rm1</name>
<value>13.0.0.120:8088</value>
</property>
<property>
<name>yarn.resourcemanager.webapp.address.rm2</name>
<value>13.0.0.202:8088</value>
</property>

<property>
<name>yarn.resourcemanager.zk-address</name>
<description>Port 2181 ; </description>
<value>13.0.0.120:2181,13.0.0.202:2181,13.0.0.239:2181</value>
</property>


<property>
<name>yarn.nodemanager.aux-services</name>
<value>mapreduce_shuffle</value>
<description>Yarn Node Manager Aux Service</description>
</property>

<property>
<name>yarn.nodemanager.aux-services.mapreduce.shuffle.class</name>
<value>org.apache.hadoop.mapred.ShuffleHandler</value>
</property>

<property>
<name>yarn.log-aggregation-enable</name>
<value>true</value>
</property>

<property>
<name>yarn.log-aggregation.retain-seconds</name>
<value>-1</value>
</property>

<property>
<name>yarn.nodemanager.local-dirs</name>
<value>file:///home/ec2-user/tdss/datanode/yarn/local</value>
</property>

<property>
<name>yarn.nodemanager.log-dirs</name>
<value>file:///home/ec2-user/tdss/datanode/yarn/logs</value>
</property> 

<property>
<name>yarn.nodemanager.pmem-check-enabled</name>
<value>false</value>
</property>

<property>
<name>yarn.nodemanager.vmem-check-enabled</name>
<value>false</value>
</property>

<property>
<name>yarn.nodemanager.resource.cpu-vcores</name>
<value>5</value>
</property>

<property>
<name>yarn.nodemanager.resource.memory-mb</name>
<value>15120</value>
</property>

<property>
<name>yarn.scheduler.minimum-allocation-vcores</name>
<value>1</value>
</property>

<property>
<name>yarn.scheduler.maximum-allocation-vcores</name>
<value>44</value>
</property>

<property>
<name>yarn.scheduler.increment-allocation-vcores</name>
<value>1</value>
</property>

<property>
<name>yarn.scheduler.minimum-allocation-mb</name>
<value>1024</value>
</property>

<property>
<name>yarn.scheduler.maximum-allocation-mb</name>
<value>250880</value>
</property>

<property>
<name>yarn.scheduler.increment-allocation-mb</name>
<value>512</value>
</property>

<property>
<name>yarn.resourcemanager.scheduler.class</name>
<value>org.apache.hadoop.yarn.server.resourcemanager.scheduler.fair.FairScheduler</value>
</property>

<property>
<name>yarn.scheduler.fair.allocation.file</name>
<value>/home/ec2-user/tdss/hadoop/etc/hadoop/fairScheduler.xml</value>
</property>

<property>
<name>yarn.scheduler.fair.user-as-default-queue</name>
<value>false</value>
</property>

<property>
<name>yarn.scheduler.fair.preemption</name>
<value>false</value>
</property>

<property>
<name>yarn.scheduler.fair.preemption.cluster-utilization-threshold</name>
<value>0.8f</value>
</property>

<property>
<name>yarn.scheduler.fair.sizebasedweight</name>
<value>false</value>
</property>

<property>
<name>yarn.scheduler.fair.assignmultiple</name>
<value>false</value>
</property>

<property>
<name>yarn.scheduler.fair.dynamic.max.assign</name>
<value>true</value>
</property>

<property>
<name>yarn.scheduler.fair.max.assign</name>
<value>-1</value>
</property>

<property>
<name>yarn.scheduler.fair.locality.threshold.node</name>
<value>-1.0</value>
</property>

<property>
<name>yarn.scheduler.fair.locality.threshold.rack</name>
<value>-1.0</value>
</property>

<property>
<name>yarn.scheduler.fair.allow-undeclared-pools</name>
<value>true</value>
</property>

<property>
<name>yarn.scheduler.fair.update-interval-ms</name>
<value>500</value>
</property>

<property>
<name>yarn.scheduler.increment-allocation-mb</name>
<value>1024</value>
</property>

<property>
<name>yarn.scheduler.increment-allocation-vcores</name>
<value>1</value>
</property>

<property>
<name>yarn.scheduler.fair.maximum-am-resource-percent</name>
<value>0.5</value>
</property>

<property>
<name>yarn.log.server.url</name>
<value>http://13.0.0.120:19888/jobhistory/logs</value>
</property>

<property>
<name>yarn.nodemanager.env-whitelist</name>
<value>JAVA_HOME,HADOOP_COMMON_HOME,HADOOP_HDFS_HOME,HADOOP_CONF_DIR,CLASSPATH_PREPEND_DISTCACHE,HADOOP_YARN_HOME,HADOOP_MAPRED_HOME</value>
</property>

<property>
<name>yarn.application.classpath</name>
<value>
    /home/ec2-user/tdss/hadoop/etc/hadoop,
    /home/ec2-user/tdss/hadoop/share/hadoop/common/*,
    /home/ec2-user/tdss/hadoop/share/hadoop/common/lib/*,
    /home/ec2-user/tdss/hadoop/share/hadoop/hdfs/*,
    /home/ec2-user/tdss/hadoop/share/hadoop/hdfs/lib/*,
    /home/ec2-user/tdss/hadoop/share/hadoop/mapreduce/*,
    /home/ec2-user/tdss/hadoop/share/hadoop/mapreduce/lib/*,
    /home/ec2-user/tdss/hadoop/share/hadoop/yarn/*,
    /home/ec2-user/tdss/hadoop/share/hadoop/yarn/lib/*
</value>
</property>



<property>
<name>yarn.nodemanager.remote-app-log-dir</name>
<value>/app/yarn/logs</value>
</property>

<property>
<name>yarn.nodemanager.remote-app-log-dir-suffix</name>
<value>logs</value>
</property>

</configuration>
